INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-03_40.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3.8"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-03_41.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3.8"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
WARNING:kivy:stderr: Traceback (most recent call last):
WARNING:kivy:stderr:   File "main.py", line 9, in <module>
WARNING:kivy:stderr:     from frontend.app import TradingApp
WARNING:kivy:stderr:   File "/home/ambaence/Downloads/AiKrakBot/frontend/app.py", line 23, in <module>
WARNING:kivy:stderr:     from backend.backtester import Backtester
WARNING:kivy:stderr:   File "/home/ambaence/Downloads/AiKrakBot/backend/backtester.py", line 3, in <module>
WARNING:kivy:stderr:     from api_handler import KrakenAPI
WARNING:kivy:stderr: ModuleNotFoundError: No module named 'api_handler'
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-03_42.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3.8"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
WARNING:kivy:stderr: Traceback (most recent call last):
WARNING:kivy:stderr:   File "main.py", line 9, in <module>
WARNING:kivy:stderr:     from frontend.app import TradingApp
WARNING:kivy:stderr:   File "/home/ambaence/Downloads/AiKrakBot/frontend/app.py", line 23, in <module>
WARNING:kivy:stderr:     from backend.backtester import Backtester
WARNING:kivy:stderr:   File "/home/ambaence/Downloads/AiKrakBot/backend/backtester.py", line 3, in <module>
WARNING:kivy:stderr:     from api_handler import KrakenAPI
WARNING:kivy:stderr: ModuleNotFoundError: No module named 'api_handler'
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-03_43.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3.8"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
WARNING:kivy:stderr: Traceback (most recent call last):
WARNING:kivy:stderr:   File "main.py", line 9, in <module>
WARNING:kivy:stderr:     from frontend.app import TradingApp
WARNING:kivy:stderr:   File "/home/ambaence/Downloads/AiKrakBot/frontend/app.py", line 23, in <module>
WARNING:kivy:stderr:     from backend.backtester import Backtester
WARNING:kivy:stderr:   File "/home/ambaence/Downloads/AiKrakBot/backend/backtester.py", line 3, in <module>
WARNING:kivy:stderr:     from api_handler import KrakenAPI
WARNING:kivy:stderr: ModuleNotFoundError: No module named 'api_handler'
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-03_44.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3.8"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f82068adee0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f820470c670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f820470c5e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f82068adee0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f8204522040> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f8204522430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f8204522670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f8204522ee0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f820422ddc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f820422d8b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f820422d430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f820421c700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f820421cca0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f8204059550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f8204059e50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f8204059280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f82040fc310>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f81fc7dc550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f81fc7ef280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f8204059820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f81fc7ef8b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f81fc7ef4c0>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f81fc7dc0d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f82040fc310>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f81fc49f8b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f81fc49fca0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f81fc49f8b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f81fc3ee310> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f81fc49fd30>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-03_45.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3.8"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff3b7e22dc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff3b4504550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff3b7e22e50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff3b4504310> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7ff3b4419ee0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7ff3b429a310> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7ff3b429a1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7ff3b429adc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff39a75a5e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff39a692280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff39a692280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff39a692940> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7ff39a6924c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7ff39a6564c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7ff39a656ee0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7ff39a6569d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7ff39a68f970>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff39a5ef820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff39a5a1310> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff39a656670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff39a5a1940> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7ff39a5a1550>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7ff39a5ef160> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7ff39a68f970>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff398ab0940> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff398ab0d30> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff398ab0940> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff3989823a0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7ff398ab0dc0>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-04_2.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3.8"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff55f332d30> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff55c2754c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff55f332dc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff55c275280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7ff55c19be50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7ff55c00f280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7ff55c00f160> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7ff55c00fd30> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff545d73700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff545ca21f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff545ca2160> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff545ca28b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7ff545ca2430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7ff545beb430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7ff545bebe50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7ff545beb940> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7ff545b9a400>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff545b76550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff545b09280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff545beb5e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff545b098b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7ff545b094c0>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7ff545b760d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7ff545b9a400>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff523ffa8b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff523ffaca0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7ff523ffa8b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7ff523eca310> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7ff523ffad30>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-05_1.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3.8"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f98b7d23e50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f98b44015e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f98b4401f70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f98b4401040> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f98b438df70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f98b42173a0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f98b42175e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f98b4217e50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f98a65b74c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f98a65b7700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f98a65b7550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f98a66f48b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f98a66f4550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f98a65bf550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f98a65bff70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f98a650a1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f98a65b5be0>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f98a64ef280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f98a64913a0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f98a65bf700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f98a64919d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f98a64915e0>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f98a64ef1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f98a65b5be0>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f98a49af9d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f98a49afdc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f98a49af9d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f98a487c430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f98a49afd30>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-05_2.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3.8"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f5c25c43e50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f5c243245e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f5c24324f70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f5c24324040> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f5c242b1f70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f5c2413b3a0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f5c2413b5e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f5c2413be50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f5c1c55c4c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f5c1c55c310> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f5c1c55c700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f5c1c5efca0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f5c1c5ef3a0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f5c1c4fc550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f5c1c4fcf70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f5c1c3fb1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f5c1c428f70>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f5c1c3ea280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f5c1c3893a0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f5c1c4fc700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f5c1c3899d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f5c1c3895e0>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f5c1c3ea1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f5c1c428f70>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f5c1c0ae9d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f5c1c0aedc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f5c1c0ae9d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f5be1f41430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f5c1c0aed30>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-05_3.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3.8"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f2a524c2e50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f2a503a25e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f2a503a2f70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f2a503a2040> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f2a5032ef70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f2a501b93a0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f2a501b95e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f2a501b9e50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f2a38d2f4c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f2a38d2f310> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f2a38d2f550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f2a38e71550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f2a38e715e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f2a38d6c550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f2a38d6cf70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f2a38c881f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f2a38de8a30>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f2a38c6a280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f2a38c173a0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f2a38d6c700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f2a38c179d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f2a38c175e0>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f2a38c6a1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f2a38de8a30>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f2a381309d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f2a38130dc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f2a381309d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f2a177c1430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f2a38130d30>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-05_11.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3.8"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f823fb93e50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f823c2715e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f823c271f70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f823c271040> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f823c1fdf70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f823c0873a0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f823c0875e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f823c087e50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f82064df4c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f82064dfe50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f82064df1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f8206573e50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f82065735e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f8206483550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f8206483f70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f82064511f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f82063dbe20>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f820636c280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f82063113a0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f8206483700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f82063119d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f82063115e0>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f820636c1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f82063dbe20>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f82048309d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f8204830dc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f82048309d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f82046fc430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f8204830d30>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-05_12.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3.8"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd743193e50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd7400725e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd740072f70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd740072040> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7fd719ff1f70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7fd719dfc3a0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7fd719dfc5e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7fd719dfce50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_4_grad/transpose:0, gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd719abd4c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd719abd310> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd719abd700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd719b73700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fd719b73a60> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fd719a49550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fd719a49f70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7fd7199901f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7fd719b08a30>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd719977280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd7199293a0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd719a49700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd7199299d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7fd7199295e0>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7fd7199771f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7fd719b08a30>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd70fdfa9d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd70fdfadc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd70fdfa9d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd70fd35430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7fd70fdfad30>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-12_0.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fc62dd1cf70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fc62c411700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fc62c4114c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fc62dd1cb80> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7fc62c1d30d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7fc62c1d34c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7fc62c1d3700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7fc62c1d3e50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fc6104d88b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fc61069f4c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fc61069f8b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fc61069faf0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fc61069fc10> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fc61054f670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fc6105d30d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7fc6105d3310> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7fc610636790>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fc6104b4040> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fc6104b44c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fc61054f4c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fc6104b4a60> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7fc6104a0670>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7fc6104a0310> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7fc610636790>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fc610161c10> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fc6100a70d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fc61054fee0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fc6100a7670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7fc610161ca0>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-12_1.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f6af030f0d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f6af030f820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f6af030f820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f6af0256670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f6af00df1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f6af00df5e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f6af00df820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f6af00dfe50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f6ad0c6e9d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f6ad0d9edc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f6ad0d9e4c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f6ad0d9ed30> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f6ad0d9e940> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f6ad0cec790> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f6ad0bf31f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f6ad0bf3430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f6ad0c9e5e0>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f6ad0bb8160> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f6ad0bb85e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f6ad0d9e940> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f6ad0bb84c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f6ad0bb8820>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f6ad0b9b430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f6ad0c9e5e0>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f6ad0062d30> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f6ab3760160> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f6ad00cfb80> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f6ab3760790> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f6ad0062790>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-12_2.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f933c442160> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f933c4428b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f933c4428b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f933c386700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f933c211280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f933c211670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f933c2118b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f933c2115e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f93206ddb80> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f93205b94c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f93205b91f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f93205b9280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f93205b9940> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f93205cc820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f93205b7280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f93205b7550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f932069b370>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f93204f21f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f93204f2670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f93205b91f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f93204f2670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f93205b70d0>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f93204e2820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f932069b370>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f93201a2dc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f93200da1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f93200da790> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f93200da820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f93201a2a60>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-12_3.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd0cc24a0d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd0cc24a820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd0cc24a820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd0cc190670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7fd0c07ed1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7fd0c07ed5e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7fd0c07ed820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7fd0c07ede50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd0c04f7a60> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd0c04dda60> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd0c04dd790> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd0c04ddf70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fd0c04dddc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fd0c0328790> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fd0c039f1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7fd0c039f430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7fd0c04eb6a0>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd0c02ed160> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd0c02ed5e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd0c04dddc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd0c02ed4c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7fd0c02ed820>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7fd0c02d8430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7fd0c04eb6a0>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd082765d30> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd08269e160> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fd0827d2b80> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fd08269e790> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7fd082765790>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-12_6.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
WARNING:kivy:stderr: Traceback (most recent call last):
WARNING:kivy:stderr:   File "/home/ambaence/Downloads/AiKrakBot/backend/backtester.py", line 4, in <module>
WARNING:kivy:stderr:     from api_handler import KrakenAPI  # Ensure this path is correct
WARNING:kivy:stderr: ModuleNotFoundError: No module named 'api_handler'
WARNING:kivy:stderr: 
WARNING:kivy:stderr: During handling of the above exception, another exception occurred:
WARNING:kivy:stderr: 
WARNING:kivy:stderr: Traceback (most recent call last):
WARNING:kivy:stderr:   File "main.py", line 9, in <module>
WARNING:kivy:stderr:     from frontend.app import TradingApp
WARNING:kivy:stderr:   File "/home/ambaence/Downloads/AiKrakBot/frontend/app.py", line 23, in <module>
WARNING:kivy:stderr:     from backend.backtester import Backtester
WARNING:kivy:stderr:   File "/home/ambaence/Downloads/AiKrakBot/backend/backtester.py", line 8, in <module>
WARNING:kivy:stderr:     from api_handler import KrakenAPI
WARNING:kivy:stderr: ModuleNotFoundError: No module named 'api_handler'
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-12_7.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
WARNING:kivy:stderr: Traceback (most recent call last):
WARNING:kivy:stderr:   File "/home/ambaence/Downloads/AiKrakBot/backend/backtester.py", line 4, in <module>
WARNING:kivy:stderr:     from api_handler import KrakenAPI  # Ensure this path is correct
WARNING:kivy:stderr: ModuleNotFoundError: No module named 'api_handler'
WARNING:kivy:stderr: 
WARNING:kivy:stderr: During handling of the above exception, another exception occurred:
WARNING:kivy:stderr: 
WARNING:kivy:stderr: Traceback (most recent call last):
WARNING:kivy:stderr:   File "main.py", line 9, in <module>
WARNING:kivy:stderr:     from frontend.app import TradingApp
WARNING:kivy:stderr:   File "/home/ambaence/Downloads/AiKrakBot/frontend/app.py", line 23, in <module>
WARNING:kivy:stderr:     from backend.backtester import Backtester
WARNING:kivy:stderr:   File "/home/ambaence/Downloads/AiKrakBot/backend/backtester.py", line 8, in <module>
WARNING:kivy:stderr:     from api_handler import KrakenAPI
WARNING:kivy:stderr: ModuleNotFoundError: No module named 'api_handler'
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-12_8.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.security:Generated new encryption key
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcbcc3480d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcbcc348820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcbcc348820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcbcc291670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7fcbcc1171f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7fcbcc1175e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7fcbcc117820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7fcbcc117e50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcba65f79d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcba65e0f70> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcba65e0b80> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcba65e08b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fcba65e0ca0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fcba649b790> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fcba64c81f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7fcba64c8430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7fcba64a09d0>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcba63e0160> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcba63e05e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcba65e0ca0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcba63e04c0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7fcba63e0820>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7fcba63da430> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7fcba64a09d0>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcba489fd30> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcba47d6160> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcba490cb80> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcba47d6790> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7fcba489f790>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-12_9.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcc04448160> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcc044488b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcc044488b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcc0438c700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7fcc04215280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7fcc04215670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7fcc042158b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7fcc042155e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcbd96ed790> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcbd96ed160> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcbd96ed0d0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcbd96edb80> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fcbd96edaf0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fcbd95a1820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7fcbd95d4280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7fcbd95d4550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7fcbd9591040>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcbd94ea1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcbd94ea670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcbd96edee0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcbd94ea670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7fcbd95d40d0>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7fcbd94de820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7fcbd9591040>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcbd81a0dc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcbd80da1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7fcbd80da790> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7fcbd80da820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7fcbd81a0a60>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
INFO:kivy:Kivy: v2.3.1
INFO:kivy:Logger: Record log in /home/ambaence/.kivy/logs/kivy_25-04-12_10.txt
INFO:kivy:Kivy: Installed at "/home/ambaence/.local/lib/python3.8/site-packages/kivy/__init__.py"
INFO:kivy:Python: v3.8.10 (default, Mar 18 2025, 20:04:55) 
[GCC 9.4.0]
INFO:kivy:Python: Interpreter at "/usr/bin/python3"
INFO:kivy:Logger: Purge log fired. Processing...
INFO:kivy:Logger: Purge finished!
INFO:kivy:Factory: 195 symbols loaded
INFO:kivy:Image: Providers: img_tex, img_dds, img_sdl2, img_pil (img_ffpyplayer ignored)
INFO:kivy:Text: Provider: sdl2
INFO:kivy:Window: Provider: sdl2
INFO:kivy:GL: Using the "OpenGL" graphics system
INFO:kivy:GL: Backend used <sdl2>
INFO:kivy:GL: OpenGL version <b'4.6 (Compatibility Profile) Mesa 21.2.6'>
INFO:kivy:GL: OpenGL vendor <b'AMD'>
INFO:kivy:GL: OpenGL renderer <b'AMD Radeon R7 Graphics (CARRIZO, DRM 3.35.0, 5.4.0-212-generic, LLVM 12.0.0)'>
INFO:kivy:GL: OpenGL parsed version: 4, 6
INFO:kivy:GL: Shading version <b'4.60'>
INFO:kivy:GL: Texture max size <16384>
INFO:kivy:GL: Texture max units <32>
INFO:kivy:Window: auto add sdl2 input provider
INFO:kivy:Window: virtual keyboard not allowed, single mode, not docked
DEBUG:asyncio:Using selector: EpollSelector
INFO:__main__:{'event': 'initialization_start', 'simulate': True}
INFO:backend.api_handler:{'event': 'get_balance', 'cached': True}
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f423c109160> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f423c1098b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm/Identity:0' shape=(2, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f423c1098b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f423c04e700> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 200), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(200,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/zeros_1:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'lstm_1/Identity:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_1:0' shape=(50, 200) dtype=float32>, <tf.Tensor 'lstm_1/Identity_2:0' shape=(200,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f421ceae280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f421ceae670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'gru/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru/Identity:0' shape=(2, 150) dtype=float32>, <tf.Tensor 'gru/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 50) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_gru at 0x7f421ceae8b0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function gru_with_backend_selection.<locals>.gpu_gru_with_fallback at 0x7f421ceae5e0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 50), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 50), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(50, 150), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 150), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 50) dtype=float32>, <tf.Tensor 'gru_1/zeros:0' shape=(None, 50) dtype=float32>, <tf.Tensor 'gru_1/Identity:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_1:0' shape=(50, 150) dtype=float32>, <tf.Tensor 'gru_1/Identity_2:0' shape=(2, 150) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 50) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/zeros_like:0, gradients/zeros_like_1:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0, gradients/concat_grad/Slice_2:0, gradients/concat_grad/Slice_3:0, gradients/concat_grad/Slice_4:0, gradients/concat_grad/Slice_5:0, gradients/concat_grad/Slice_6:0, gradients/concat_grad/Slice_7:0, gradients/concat_grad/Slice_8:0, gradients/concat_grad/Slice_9:0, gradients/concat_grad/Slice_10:0, gradients/concat_grad/Slice_11:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_7_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_2_grad/transpose:0, gradients/transpose_1_grad/transpose:0, gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_4_grad/transpose:0, gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f421cb9fe50> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f421ca551f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f421ca55310> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f421ca55790> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'Placeholder:0' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f421ca55940> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f421ca81820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100,), dtype=tf.int64, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(100,), dtype=tf.int64, name=None),)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function StructuredFunctionWrapper.__init__.<locals>.trace_tf_function.<locals>.wrapped_fn at 0x7f421cb3d280> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=args_0, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(None,), dtype=tf.int64, name=None)), Parameter(name=args_1, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None)), Parameter(name=args_2, kind=POSITIONAL_ONLY, optional=False, type_constraint=TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (TensorSpec(shape=(None,), dtype=tf.int64, name=None), TensorSpec(shape=(100, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(100, 1), dtype=tf.float32, name=None))] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f421cb3d550> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f421cb52250>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f421c9b51f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f421c9b5670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f421ca55310> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f421c9b5670> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-6377 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f421cb3d0d0>) in gradient.
Level 1:tensorflow:Creating new FuncGraph for Python function <function Model.make_train_function.<locals>.train_function at 0x7f421c99a820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=iterator, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=IteratorSpec((TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None), TensorSpec(shape=(None, 1), dtype=tf.float32, name=None)),))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tensorflow.python.data.ops.iterator_ops.OwnedIterator object at 0x7f421cb52250>,)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f41f6e24dc0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f41f6d5f1f0> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 2), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 64), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(2, 256), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 256), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(256,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=True))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'IteratorGetNext:0' shape=(None, 20, 2) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/zeros_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity:0' shape=(2, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_1:0' shape=(64, 256) dtype=float32>, <tf.Tensor 'model_2/lstm1/Identity_2:0' shape=(256,) dtype=float32>, None, False, False, None, False, True)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_9'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_9_grad/transpose:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/AddN:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Creating new FuncGraph for Python function <function standard_lstm at 0x7f41f6d5f790> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Creating new FuncGraph for Python function <function lstm_with_backend_selection.<locals>.gpu_lstm_with_fallback at 0x7f41f6d5f820> (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0)), FunctionType(parameters=[Parameter(name=inputs, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 20, 64), dtype=tf.float32, name=None)), Parameter(name=init_h, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=init_c, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(None, 32), dtype=tf.float32, name=None)), Parameter(name=kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(64, 128), dtype=tf.float32, name=None)), Parameter(name=recurrent_kernel, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(32, 128), dtype=tf.float32, name=None)), Parameter(name=bias, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=TensorSpec(shape=(128,), dtype=tf.float32, name=None)), Parameter(name=mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=time_major, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=go_backwards, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=sequence_lengths, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=None)), Parameter(name=zero_output_for_mask, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False)), Parameter(name=return_sequences, kind=POSITIONAL_OR_KEYWORD, optional=False, type_constraint=Literal(value=False))], captures=OrderedDict()))
Level 2:tensorflow:Python function signature [args: (<tf.Tensor 'model_2/lstm1/PartitionedCall:1' shape=(None, 20, 64) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/zeros_1:0' shape=(None, 32) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity:0' shape=(64, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_1:0' shape=(32, 128) dtype=float32>, <tf.Tensor 'model_2/lstm2/Identity_2:0' shape=(128,) dtype=float32>, None, False, False, None, False, False)] [kwargs: {}]
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'ExpandDims_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/ExpandDims_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/Squeeze_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Squeeze_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/Squeeze_1_grad/Reshape:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'strided_slice'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/strided_slice_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'CudnnRNN'
Level 1:tensorflow:  in  --> gradients/strided_slice_grad/StridedSliceGrad:0, gradients/Squeeze_grad/Reshape:0, gradients/Squeeze_1_grad/Reshape:0, gradients/zeros_like:0
Level 1:tensorflow:  out --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0, gradients/CudnnRNN_grad/CudnnRNNBackprop:1, gradients/CudnnRNN_grad/CudnnRNNBackprop:2, gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'ExpandDims'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:1
Level 1:tensorflow:  out --> gradients/ExpandDims_grad/Reshape:0
Level 1:tensorflow:Gradient for 'ExpandDims_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:2
Level 1:tensorflow:  out --> gradients/ExpandDims_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'concat_1'
Level 1:tensorflow:  in  --> gradients/CudnnRNN_grad/CudnnRNNBackprop:3
Level 1:tensorflow:  out --> gradients/concat_1_grad/Slice:0, gradients/concat_1_grad/Slice_1:0, gradients/concat_1_grad/Slice_2:0, gradients/concat_1_grad/Slice_3:0, gradients/concat_1_grad/Slice_4:0, gradients/concat_1_grad/Slice_5:0, gradients/concat_1_grad/Slice_6:0, gradients/concat_1_grad/Slice_7:0, gradients/concat_1_grad/Slice_8:0, gradients/concat_1_grad/Slice_9:0, gradients/concat_1_grad/Slice_10:0, gradients/concat_1_grad/Slice_11:0, gradients/concat_1_grad/Slice_12:0, gradients/concat_1_grad/Slice_13:0, gradients/concat_1_grad/Slice_14:0, gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:Gradient for 'Reshape'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice:0
Level 1:tensorflow:  out --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_1'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_1:0
Level 1:tensorflow:  out --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_2'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_2:0
Level 1:tensorflow:  out --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_3'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_3:0
Level 1:tensorflow:  out --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_4'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_4:0
Level 1:tensorflow:  out --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_5'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_5:0
Level 1:tensorflow:  out --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_6'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_6:0
Level 1:tensorflow:  out --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_7'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_7:0
Level 1:tensorflow:  out --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_8'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_8:0
Level 1:tensorflow:  out --> gradients/Reshape_8_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_9'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_9:0
Level 1:tensorflow:  out --> gradients/Reshape_9_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_10'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_10:0
Level 1:tensorflow:  out --> gradients/Reshape_10_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_11'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_11:0
Level 1:tensorflow:  out --> gradients/Reshape_11_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_12'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_12:0
Level 1:tensorflow:  out --> gradients/Reshape_12_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_13'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_13:0
Level 1:tensorflow:  out --> gradients/Reshape_13_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_14'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_14:0
Level 1:tensorflow:  out --> gradients/Reshape_14_grad/Reshape:0
Level 1:tensorflow:Gradient for 'Reshape_15'
Level 1:tensorflow:  in  --> gradients/concat_1_grad/Slice_15:0
Level 1:tensorflow:  out --> gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/Reshape_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_2'
Level 1:tensorflow:  in  --> gradients/Reshape_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_2_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_3'
Level 1:tensorflow:  in  --> gradients/Reshape_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_3_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_4'
Level 1:tensorflow:  in  --> gradients/Reshape_3_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_5'
Level 1:tensorflow:  in  --> gradients/Reshape_4_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_5_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_6'
Level 1:tensorflow:  in  --> gradients/Reshape_5_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_6_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_7'
Level 1:tensorflow:  in  --> gradients/Reshape_6_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_7_grad/transpose:0
Level 1:tensorflow:Gradient for 'transpose_8'
Level 1:tensorflow:  in  --> gradients/Reshape_7_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:Gradient for 'split_2'
Level 1:tensorflow:  in  --> gradients/Reshape_8_grad/Reshape:0, gradients/Reshape_9_grad/Reshape:0, gradients/Reshape_10_grad/Reshape:0, gradients/Reshape_11_grad/Reshape:0, gradients/Reshape_12_grad/Reshape:0, gradients/Reshape_13_grad/Reshape:0, gradients/Reshape_14_grad/Reshape:0, gradients/Reshape_15_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/split_2_grad/concat:0
Level 1:tensorflow:Gradient for 'split'
Level 1:tensorflow:  in  --> gradients/transpose_1_grad/transpose:0, gradients/transpose_2_grad/transpose:0, gradients/transpose_3_grad/transpose:0, gradients/transpose_4_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_grad/concat:0
Level 1:tensorflow:Gradient for 'split_1'
Level 1:tensorflow:  in  --> gradients/transpose_5_grad/transpose:0, gradients/transpose_6_grad/transpose:0, gradients/transpose_7_grad/transpose:0, gradients/transpose_8_grad/transpose:0
Level 1:tensorflow:  out --> gradients/split_1_grad/concat:0
Level 1:tensorflow:Gradient for 'concat'
Level 1:tensorflow:  in  --> gradients/split_2_grad/concat:0
Level 1:tensorflow:  out --> gradients/concat_grad/Slice:0, gradients/concat_grad/Slice_1:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (1, None, 32) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 32) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (128,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (32, 128) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Gradient for 'Identity'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'Identity_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'Identity_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'Identity_3'
Level 1:tensorflow:  in  --> gradients/grad_ys_3:0
Level 1:tensorflow:  out --> gradients/grad_ys_3:0
Level 1:tensorflow:Gradient for 'strided_slice_2'
Level 1:tensorflow:  in  --> gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/strided_slice_2_grad/StridedSliceGrad:0
Level 1:tensorflow:Gradient for 'transpose_1'
Level 1:tensorflow:  in  --> gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/transpose_1_grad/transpose:0
Level 2:tensorflow:  _AggregatedGrads 2 x (20, None, 64) using add_n
Level 1:tensorflow:Gradient for 'TensorArrayV2Stack/TensorListStack'
Level 1:tensorflow:  in  --> gradients/AddN:0
Level 1:tensorflow:  out --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0
Level 1:tensorflow:Gradient for 'while/Identity_3'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:Gradient for 'while/Identity_4'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_1:0
Level 1:tensorflow:Gradient for 'while/Identity_5'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/grad_ys_2:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Write/TensorListSetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/grad_ys_0:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListSetItem:0, gradients/while_grad/gradients/while/TensorArrayV2Write/TensorListSetItem_grad/TensorListGetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/mul_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0, gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_2'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_2_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_1_grad/TanhGrad:0
Level 2:tensorflow:  _AggregatedGrads 2 x (None, 64) using add_n
Level 1:tensorflow:Gradient for 'while/add_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/AddN_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0, gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_grad/Reshape:0, gradients/while_grad/gradients/while/mul_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/mul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0, gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:Gradient for 'while/Sigmoid_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Sigmoid'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0
Level 1:tensorflow:Gradient for 'while/Tanh'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/mul_1_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0
Level 1:tensorflow:Gradient for 'while/split'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/Sigmoid_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Sigmoid_1_grad/SigmoidGrad:0, gradients/while_grad/gradients/while/Tanh_grad/TanhGrad:0, gradients/while_grad/gradients/while/Sigmoid_2_grad/SigmoidGrad:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:Gradient for 'while/BiasAdd'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/split_grad/concat:0, gradients/while_grad/gradients/while/BiasAdd_grad/BiasAddGrad:0
Level 1:tensorflow:Gradient for 'while/add'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/split_grad/concat:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/add_grad/Reshape:0, gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 2:tensorflow:  _AggregatedGrads 2 x (256,) using add_n
Level 1:tensorflow:Gradient for 'while/MatMul'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/MatMul_1'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/add_grad/Reshape_1:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/MatMul_1_grad/MatMul:0, gradients/while_grad/gradients/while/MatMul_1_grad/MatMul_1:0
Level 1:tensorflow:Gradient for 'while/TensorArrayV2Read/TensorListGetItem'
Level 1:tensorflow:  in  --> gradients/while_grad/gradients/while/MatMul_grad/MatMul:0
Level 1:tensorflow:  out --> gradients/while_grad/gradients/while/TensorArrayV2Read/TensorListGetItem_grad/TensorListSetItem:0
Level 2:tensorflow:  _AggregatedGrads 2 x (2, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x (64, 256) using add_n
Level 2:tensorflow:  _AggregatedGrads 2 x () using add_n
Level 1:tensorflow:Gradient for 'while'
Level 1:tensorflow:  in  --> gradients/TensorArrayV2Stack/TensorListStack_grad/TensorListFromTensor:0, gradients/grad_ys_2:0, gradients/grad_ys_3:0, gradients/zeros_like:0, gradients/zeros_like_1:0, gradients/zeros_like_2:0, gradients/zeros_like_3:0
Level 1:tensorflow:  out --> gradients/while_grad/Identity_3:0, gradients/while_grad/Identity_4:0, gradients/while_grad/Identity_5:0, gradients/while_grad/Identity_6:0, gradients/while_grad/Identity_7:0, gradients/while_grad/Identity_8:0, gradients/while_grad/Identity_9:0
Level 1:tensorflow:Gradient for 'TensorArrayUnstack/TensorListFromTensor'
Level 1:tensorflow:  in  --> gradients/while_grad/Identity_6:0
Level 1:tensorflow:  out --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:Gradient for 'transpose'
Level 1:tensorflow:  in  --> gradients/TensorArrayUnstack/TensorListFromTensor_grad/TensorListStack:0
Level 1:tensorflow:  out --> gradients/transpose_grad/transpose:0
Level 1:tensorflow:Registering CustomGradient-8918 (<function _graph_mode_decorator.<locals>.internal_grad_fn at 0x7f41f6e24a60>) in gradient.
INFO:backend.ml_engine.transfer_learning:Simulated pre-trained weights initialized
INFO:backend.ml_engine.transfer_learning:Froze 2 pre-trained layers for fine-tuning
INFO:backend.ml_engine.gan_model:Initializing GANModel on device: cpu
INFO:backend.ml_engine.hrl_model:{'event': 'hrl_init', 'device': 'cpu', 'state_size': 4, 'action_size': 3}
ERROR:__main__:{'event': 'unexpected_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
ERROR:__main__:{'event': 'fatal_error', 'error': '__init__() takes 3 positional arguments but 4 were given'}
